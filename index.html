<html>



  <head>
    <title>My Twitter</title>
    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css" />
    <script defer src="https://pyscript.net/latest/pyscript.js"></script>

  </head>





  <body id="body" >
    <div class="tweet-box">
      <textarea id="tweet-text" placeholder="توئیت خود را وارد کنید"></textarea>
    </div>

    <button py-click="submitTweet()">توئیت</button>


    <py-config>
      packages = ["requests", "urllib3", "ssl"]
      [[fetch]]
      files = ["/cacert.pem", "/cacert2.pem", "/req.py"]
    </py-config>
    

    <py-script>
      import asyncio
      import json
      
      from req import request

      

      from datetime import datetime
      now = datetime.now()
      time = now.strftime("%d/%m/%Y %H:%M:%S")

      async def submitTweet():
        baseurl = "https://jsonplaceholder.typicode.com"
        headers = {"Content-type": "application/json"}
        response = await request(f"{baseurl}/posts/2", method="GET", headers=headers)
        print(f"GET request=> status:{response.status}, json:{await response.json()}")
        
        
        


        display(Element('tweet-text').element.value + " ----------> " + time + r.status_code, target="body")




        Element('tweet-text').element.value = ""
      asyncio.ensure_future(submitTweet())
    </py-script>







  </body>
</html>
